{% extends 'base.html' %}
{% load static %}

{% block title %}{{ item.titulo }} - FIND{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'mainpage/css/item_detail.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.3/font/bootstrap-icons.min.css">

<div class="container my-5">
  <div class="row g-4 align-items-start">

    <!-- CARD ITEM -->
    <div class="col-lg-8">
      <div class="card item-detail-card p-4">

        <div class="item-image-wrapper mb-3">
          <img
            src="{% if item.imagem %}{{ item.imagem.url }}{% else %}{% static 'mainpage/img/item-default.png' %}{% endif %}"
            alt="{{ item.titulo }}"
          >
        </div>

        <span class="status-badge {{ item.status }}">
          {{ item.get_status_display }}
        </span>

        <h4 class="item-title mt-2">{{ item.titulo }}</h4>

        <p class="item-description">
          {{ item.descricao|default:"Sem descrição." }}
        </p>

        <!-- INFO GRID (Ícone + label em cima + valor embaixo) -->
        <div class="item-info-grid mt-4">

          <div class="info-box">
            <div class="info-icon">
              <i class="bi bi-tag-fill"></i>
            </div>
            <div class="info-text">
              <span class="info-label">Categoria</span>
              <span class="info-value">
                {{ item.categoria.nome|default:"—" }}
              </span>
            </div>
          </div>

          <div class="info-box">
            <div class="info-icon">
              <i class="bi bi-geo-alt-fill"></i>
            </div>
            <div class="info-text">
              <span class="info-label">Local</span>
              <span class="info-value">
                {{ item.local|default:"—" }}
              </span>
            </div>
          </div>

          <div class="info-box">
            <div class="info-icon">
              <i class="bi bi-calendar-event-fill"></i>
            </div>
            <div class="info-text">
              <span class="info-label">Encontrado</span>
              <span class="info-value">
                {{ item.data|date:"d/m/Y" }}
              </span>
            </div>
          </div>

          <div class="info-box">
            <div class="info-icon">
              <i class="bi bi-clock-fill"></i>
            </div>
            <div class="info-text">
              <span class="info-label">Hora da publicação</span>
              <span class="info-value">
                {{ item.criado_em|time:"H:i" }}
              </span>
            </div>
          </div>

        </div>

      </div>
    </div>

    <!-- CARD CONTATO -->
    <div class="col-lg-4">
      <div class="card contact-detail-card p-4">

        <h6 class="contact-title">CONTATO</h6>

        <div class="contact-line">
          <i class="bi bi-envelope-fill"></i>
          <span>{{ item.usuario.email|default:"—" }}</span>
        </div>

        <div class="contact-line">
          <i class="bi bi-person-fill"></i>
          <span>{{ item.usuario.get_full_name|default:item.usuario.username }}</span>
        </div>

        <div class="contact-line">
          <i class="bi bi-telephone-fill"></i>
          <span>
            {% if item.usuario.profile and item.usuario.profile.telefone %}
              {{ item.usuario.profile.telefone }}
            {% else %}
              —
            {% endif %}
          </span>
        </div>

        {% if user.is_authenticated and user.id != item.usuario_id %}
          <a
            href="{% url 'chat_start' item.id %}?next={{ request.get_full_path|urlencode }}"
            class="btn-chat mt-4"
          >
            <i class="bi bi-chat-dots-fill me-2"></i> Iniciar conversa
          </a>
        {% endif %}

      </div>
    </div>

  </div>
</div>
{% endblock %}
